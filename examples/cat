#!/usr/local/bin/shale

// Here's a very simple use of the file library to implement something like cat.

// Either takes a replacement of f=\"...file...\"
// for exampe: ./cat f=\"/etc/hosts\"
// or with no replacement will ask for the file name to be entered.

file library

f initialised {
  f
} {
  "File: " print
  stdin file:: fgets file::() not {
    "no file given" println
    1 exit
  } ifthen
} if

file var
file swap =

cat var
cat {
  0$ var

  "r" open file::() {
    0$ swap =
    { 0$ fgets file::() } {
      println
    } while
    0$ close file::()
  } {
    "Cannot open file" println
  } if
} =

file cat()
